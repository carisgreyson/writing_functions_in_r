---
output: rmarkdown::github_document
---



If you still wanted to use `dplyr()`'s `group_by()` and `summarise()` functions in a user-defined function, then variables containing the column names as strings can be enclosed by `!!as.name()` to convert them into names, like so:

```{r}

sum_group_alt1 <- function(df, group_cols, sum_col) {

  summary <- df %>%
    dplyr::group_by(!!as.name(group_cols)) %>%
    dplyr::summarise(counts = sum(!!as.name(sum_col))) %>%
    janitor::adorn_totals("row")

  return(summary)

}

prosecutions_grouped <- sum_group_alt1(df = prosecutions, group_cols = "age_range", sum_col = "count")

prosecutions_grouped

```

Alternatively, this version of the function means the column names can be input as function arguments directly (rather than needing to enclose them in quote marks to turn them into strings).

```{r}
sum_group_alt2 <- function(df, group_cols, sum_col) {

  summary <- df %>%
    dplyr::group_by(!!enquo(group_cols)) %>%
    dplyr::summarise(counts = sum(!!enquo(sum_col))) %>%
    janitor::adorn_totals("row")

  return(summary)

}

prosecutions_grouped <- sum_group_alt2(df = prosecutions, group_cols = age_range, sum_col = count)

prosecutions_grouped

```

